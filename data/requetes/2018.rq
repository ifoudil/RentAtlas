PREFIX rcw: <https://cours.iut-orsay.fr/rcw/>

SELECT ?code 
	(AVG(xsd:float(?moyMaison)) AS ?avgMaison)
	(AVG(xsd:float(?moyAppart)) AS ?avgAppart)
	(AVG(xsd:float(?maxMaison)) AS ?avgMaxMaison)
	(AVG(xsd:float(?maxAppart)) AS ?avgMaxAppart)
	(AVG(xsd:float(?minMaison)) AS ?avgMinMaison)
	(AVG(xsd:float(?minAppart)) AS ?avgMinAppart)
WHERE {
	?dept rcw:codeDep ?code ;
		  rcw:comprend ?commune .
	?commune rcw:loyerMaison2018 ?moyMaison;
			 rcw:loyerAppart2018 ?moyAppart;
			 rcw:loyerMaxMaison2018 ?maxMaison;
			 rcw:loyerMaxAppart2018 ?maxAppart;
			 rcw:loyerMinAppart2018 ?minMaison;
			 rcw:loyerMinAppart2018 ?minAppart;
}
GROUP BY ?code